var $j=jQuery.noConflict();$j(document).ready(function(){function e(e){$j.ajax({type:"post",dataType:"json",url:Cupg_Ajax.ajaxurl,data:e})}function p(e){for(var p=e+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var o=t[n];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(p)){var i=o.substring(p.length,o.length);if(i.length>0)return i=decodeURIComponent(i),JSON.parse(i)}}return""}function t(e,p,t){var n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3);var o="expires="+n.toUTCString();document.cookie=e+"="+p+"; "+o}function n(t,n){t.show(),$j(".cupg_poweredby.cupg_hidden").remove();var o=p(Cupg_Session.cookies.session);"undefined"!=typeof o.name&&t.find(".cupg_name_input").val(unescape(o.name)),"undefined"!=typeof o.email&&t.find(".cupg_email_input").val(o.email);var i={action:"cupg_popups",popup_type:n,upgrade_id:t.attr("data-id"),header_id:t.find(".cupg_header").attr("data-id")};e(i),c("off")}function o(e){var n=p(Cupg_Session.cookies.counter),o=365,i=+Cupg_Session.popup.interval;0!=Cupg_Session.popup.max_times_shown&&(n>=Cupg_Session.popup.max_times_shown||e)&&(o=-1,i=365),t(Cupg_Session.cookies.counter,+n+1,o),t(Cupg_Session.cookies.blocker,!0,i)}function i(e){e.clientY%15===0&&(i.prev=e.clientY),e.clientY<=45&&i.prev&&i.prev>e.clientY&&(n(e.data,"popups_popup"),o(!1),$j(document).off("mousemove",i))}function u(e){var p=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return p.test(e)}function a(e,p,t,n){e.addClass("cupg_action"),e.attr("disabled","disabled");var i=e.closest(".cupg_popup"),u={action:"cupg_subscriptions",popup_type:n,upgrade_id:i.attr("data-id"),header_id:i.find(".cupg_header").attr("data-id"),email:p};"undefined"!=typeof t&&(u.subscriber_name=t),$j.ajax({type:"post",dataType:"json",url:Cupg_Ajax.ajaxurl,data:u,success:function(p){"subscriptions_popup"===n&&o(!0),"success"==p.status?"none"!==p.link&&(window.location=p.link):alert("Something went wrong.\nError code: "+p.error),s(e)},error:function(p){s(e)}})}function s(e){var p=e.find(".cupg_submit_button");p.hasClass("cupg_action")&&(p.removeAttr("disabled"),p.removeClass("cupg_action")),e.fadeOut(),c("on")}function c(e){var p=$j("html").hasClass("cupg_no_scroll");"off"!==e||p||$j("html").addClass("cupg_no_scroll"),"on"===e&&p&&$j("html").removeClass("cupg_no_scroll")}var r=[];if($j(".cupg_link_container").each(function(){var e=$j(this).attr("data-id");r.indexOf(e)===-1&&r.push(e)}),r.length>0){var _={action:"cupg_visits",upgrade_ids:r};e(_)}$j(".cupg_link_container > a").on("click",function(e){e.preventDefault();var p=$j(this).parent().attr("data-id"),t=$j(".cupg_regular_popup.cupg_upgrade_box_"+p);n($j(t),"popups")}),$j(".cupg_link_container.cupg_fancybox").on("click",function(e){e.preventDefault();var p=$j(this).attr("data-id"),t=$j(".cupg_regular_popup.cupg_upgrade_box_"+p);n($j(t),"popups")}),$j(".cupg_sitewide_popup").each(function(){var e=$j(this);"exit"!==Cupg_Session.popup.display_type?setTimeout(function(){n(e,"popups_popup"),o(!1)},1e3*Cupg_Session.popup.delay,e):$j(document).on("mousemove",e,i)}),$j(".cupg_submit_button").on("click",function(e){e.preventDefault();var p=$j(this).closest(".cupg_popup_wrapper").find(".cupg_name_input").val();if("undefined"!=typeof p&&0===p.length)return void alert("Please enter your name");var t=$j(this).closest(".cupg_popup_wrapper").find(".cupg_email_input").val();return u(t)?void($j(this).hasClass("cupg_sitewide_popup_submit")?a($j(this),t,p,"subscriptions_popup"):a($j(this),t,p,"subscriptions")):void alert("Invalid E-mail")}),$j(document).keypress(function(e){13==e.which&&$j(".cupg_popup").is(":visible")&&$j(".cupg_popup:visible").find(".cupg_submit_button").click()}),$j(".cupg_close_button").on("click",function(){s($j(this).closest(".cupg_popup"))})});